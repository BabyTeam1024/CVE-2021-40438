FROM ubuntu:18.04
WORKDIR /root
RUN apt update && apt install wget build-essential expat libexpat1-dev libpcre3-dev zlib1g-dev  libssl-dev libnghttp2-dev -y 
RUN wget http://archive.apache.org/dist/httpd/httpd-2.4.49.tar.gz && wget http://archive.apache.org/dist/apr/apr-1.6.3.tar.gz && wget http://archive.apache.org/dist/apr/apr-util-1.6.1.tar.gz 
RUN tar xvzf apr-1.6.3.tar.gz && tar xvzf apr-util-1.6.1.tar.gz && tar xvzf httpd-2.4.49.tar.gz && cp -r ~/apr-1.6.3 ~/httpd-2.4.49/srclib/apr && cp -r ~/apr-util-1.6.1 ~/httpd-2.4.49/srclib/apr-util && cd httpd-2.4.49 && ./configure --prefix=/usr/local/httpd/ --sysconfdir=/etc/httpd/ --with-include-apr --disable-userdir --enable-headers --with-mpm=worker --enable-modules=most --enable-so --enable-deflate --enable-defate=shared --enable-expires-shared --enable-rewrite=shared --enable-static-support --with-included-apr --with-ssl --with-z --enable-proxy --enable-proxy_http2 && make && make install
RUN echo -e "1\n1\n"|apt install $phpv -y --force-yes && cp /usr/local/httpd/bin/apachectl /etc/init.d/httpd 
CMD ["/bin/bash"]
